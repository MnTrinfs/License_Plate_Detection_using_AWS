<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x"
      crossorigin="anonymous"
    />
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"
    />
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/style.css" />
    <title>Home</title>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg bg-dark navbar-dark py-3 fixed-top">
      <div class="container">
        <a href="/home/index.html" class="navbar-brand flex items-center space-x-3 rtl:space-x-reverse">
            <img src="/img/Logo.png" class="h-8" alt="Logo" style="width:150px;height:60px;" />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navmenu"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navmenu">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a href="#about" class="nav-link">About</a>
            </li>
            <li class="nav-item">
              <a href="#features" class="nav-link">Features</a>
            </li>
            <li class="nav-item">
              <a href="#contact" class="nav-link">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Showcase -->
    <section id="about" class="p-5 bg-dark text-light">
      <div class="container">
        <!-- <div class="d-sm-flex align-items-center justify-content-between"> -->
        <div class="row align-items-start">
          <div class="col-md-6">
            <h1><span class="text-warning">License Plate Recognition</span></h1>
            <p class="lead my-4">
              Completely free. Supported formats: PNG, JPG, JPEG
            </p>
            <input type="file" id="imageInput" accept="image/*">
            <button class="btn btn-primary btn-lg" onclick="uploadImage()">Upload</button>  
          </div>
          <div class="col-md-6">
            <div id="result" class="p-3 rounded"></div>
          </div>
          <script>
          async function uploadImage() {
              const fileInput = document.getElementById("imageInput");
              const resultDiv = document.getElementById("result");

              if (fileInput.files.length === 0) {
                  alert("Please select an image.");
                  return;
              }

              const file = fileInput.files[0];
              const base64String = await convertToBase64(file);

              const requestData = {
                  image_data: base64String
              };

              try {
                  const response = await fetch("https://hq07do5yzi.execute-api.ap-southeast-2.amazonaws.com/prod/detect-license-plate", {
                      method: "POST",
                      mode: "cors",
                      headers: {
                          "Content-Type": "application/json"
                      },
                      body: JSON.stringify(requestData)
                  });

                  const result = await response.json();
                  console.log("API result:", result);

                  if (response.ok) {
                      resultDiv.innerHTML = `
                        <p><strong>Detected Plate:</strong> ${result.licensePlate}</p>
                        <p><strong>Detected Words:</strong> ${result.detectedWords.join(", ")}</p>
						<p><strong>Confidence:</strong> ${result.confidence}%</p>
						<p><strong>Province:</strong> ${result.province}</p>
						<p><strong>Plate Color:</strong> ${result.plateColor}
							<span style="background-color: ${getColor(result.plateColor)}; color: white; padding: 4px 8px; border-radius: 4px;">
								${result.plateColor}
							</span>
						</p>
                        <p><strong>Uploaded Image:</strong></p>
                        <img src="${result.imageURL}" alt="Uploaded Image" style="max-width: 400px; border: 1px solid #ccc;">
                      `;
                  } else {
                      resultDiv.innerText = "Error: " + (result.message || "Failed to detect");
                  }
              } catch (error) {
                  console.error("Error:", error);
                  resultDiv.innerText = "Error processing image.";
              }
          }

          function convertToBase64(file) {
              return new Promise((resolve, reject) => {
                  const reader = new FileReader();
                  reader.readAsDataURL(file);
                  reader.onload = () => resolve(reader.result.split(",")[1]);
                  reader.onerror = error => reject(error);
              });
          }
          </script>
        </div>
        
      </div>
    </section>
	


    <!-- Learn Sections -->
    <section id="learn" class="p-5">
      <div class="container">
        <div class="row align-items-center justify-content-between">
          <div class="col-md">
            <img src="/img/1.png" class="img-fluid" alt="" />
          </div>
          <div class="col-md p-5">
            <h2>Plate Recognizer Snapshot ALPR</h2>
            <p class="lead" style="text-align: justify;">
              AWS Rekognition can detect and extract text from images, making it useful for reading license plates. 
              Using the DetectText API, it identifies alphanumeric characters, 
              which can be integrated into vehicle monitoring or access control systems.</span>
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="features" class="p-5 bg-dark text-light">
      <div class="container">
        <div class="row align-items-center justify-content-between">
          <div class="col-md p-5">
            <h2>Feature-Rich ALPR</h2>
            <p class="lead" style="text-align: justify;">
              My license plate reader project can accurately recognize plates from different angles, even in blurry images or photos containing unrelated text like logos. 
              By leveraging Rekognition’s text detection capabilities, the system isolates and returns the license plate number along with its 
              position in the image, making it effective for real-world applications with noisy or imperfect input data.
            </p>
            <a href="#" class="btn btn-light mt-3" id="myBtn">
              <i class="bi bi-chevron-right"></i> Read More
            </a>
          </div>
          <div class="col-md">
            <img src="/img/2.png" class="img-fluid" alt="" />
          </div>
        </div>
      </div>
    </section>

    <!-- Contact & Map -->
    <section id="contact" class="p-5">
      <div class="container">
        <div class="row g-4">
          <div class="col-md">
            <h2 class="text-center mb-4">Contact Info</h2>
            <ul class="list-group list-group-flush lead">
              <li class="list-group-item">
                <span class="fw-bold">Main Location:</span> District 3, HCMC
              </li>
              <li class="list-group-item">
                <span class="fw-bold">Phone:</span> 0889289526
              </li>
              <li class="list-group-item">
                <span class="fw-bold">Email:</span>
                bthong45@gmail.com
              </li>
              <li class="list-group-item">
                <span class="fw-bold">Student Email:</span>
                21207105@student.hcmus.edu.vn
              </li>
            </ul>
          </div>          
          <div class="col-md">
            <div id="map"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="p-5 bg-dark text-white text-center position-relative">
      <div class="container">
        <p class="lead">Copyright &copy; 2025 MnTri</p>

        <a href="#" class="position-absolute bottom-0 end-0 p-5">
          <i class="bi bi-arrow-up-circle h1"></i>
        </a>
      </div>
    </footer>

    <!-- Modal -->
    <div
      class="modal fade"
      id="enroll"
      tabindex="-1"
      aria-labelledby="enrollLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="enrollLabel">Enrollment</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p class="lead">Fill out this form and I will get back to you</p>
            <form>
              <div class="mb-3">
                <label for="first-name" class="col-form-label">
                  First Name:
                </label>
                <input type="text" class="form-control" id="first-name" />
              </div>
              <div class="mb-3">
                <label for="last-name" class="col-form-label">Last Name:</label>
                <input type="text" class="form-control" id="last-name" />
              </div>
              <div class="mb-3">
                <label for="email" class="col-form-label">Email:</label>
                <input type="email" class="form-control" id="email" />
              </div>
              <div class="mb-3">
                <label for="phone" class="col-form-label">Phone:</label>
                <input type="tel" class="form-control" id="phone" />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary">Submit</button>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
      crossorigin="anonymous"
    ></script>

    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.1/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.1/mapbox-gl-geocoder.css' type='text/css' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.43.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.43.0/mapbox-gl.css' rel='stylesheet' />
    <script>
      mapboxgl.accessToken = 'pk.eyJ1IjoibGF3aXgxMCIsImEiOiJjamJlOGE1bmcyZ2V5MzNtcmlyaWRzcDZlIn0.ZRQ73zzVxwcADIPvsqB6mg';
      var map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/streets-v9',
          center: [-79.4512, 43.6568],
          zoom: 13
      });
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/iconify-icon@2.3.0/dist/iconify-icon.min.js"></script>
    <script>
      function myFunction() {
        var dots = document.getElementById("dots");
        var moreText = document.getElementById("more");
        var btnText = document.getElementById("myBtn");
      
        if (dots.style.display === "none") {
          dots.style.display = "inline";
          btnText.innerHTML = "Read more"; 
          moreText.style.display = "none";
        } else {
          dots.style.display = "none";
          btnText.innerHTML = "Read less"; 
          moreText.style.display = "inline";
        }
      }
    </script>
	
	<script>
	async function uploadImage() {
		const fileInput = document.getElementById("imageInput");
		const resultDiv = document.getElementById("result");

		if (fileInput.files.length === 0) {
			alert("Please select an image.");
			return;
		}

		const file = fileInput.files[0];
		const base64String = await convertToBase64(file);

		const requestData = {
			image_data: base64String
		};

		try {
			const response = await fetch("https://hq07do5yzi.execute-api.ap-southeast-2.amazonaws.com/prod/detect-license-plate", {
				method: "POST",
				mode: "cors",
				headers: {
					"Content-Type": "application/json"
				},
				body: JSON.stringify(requestData)
			});

			const result = await response.json();
			console.log("API result:", result);

			if (response.ok) {
				resultDiv.innerHTML = `
					<p><strong>Detected Plate:</strong> ${result.licensePlate}</p>
					<p><strong>Detected Words:</strong> ${result.detectedWords.join(", ")}</p>
					<p><strong>Confidence:</strong> ${result.confidence}%</p>
					<p><strong>Province:</strong> ${result.province}</p>
					<p><strong>Uploaded Image:</strong></p>
					<img src="${result.imageURL}" alt="Uploaded Image" style="max-width: 400px; border: 1px solid #ccc;">
				`;
			} else {
				resultDiv.innerText = "Error: " + (result.message || "Failed to detect");
			}
		} catch (error) {
			console.error("Error:", error);
			resultDiv.innerText = "Error processing image.";
		}
	}

	function convertToBase64(file) {
		return new Promise((resolve, reject) => {
			const reader = new FileReader();
			reader.readAsDataURL(file);
			reader.onload = () => resolve(reader.result.split(",")[1]);
			reader.onerror = error => reject(error);
		});
	}
	</script>
	
	<script>
	  function getColor(color) {
		switch (color) {
		  case "Trắng": return "#ccc";
		  case "Vàng": return "#e6c200";
		  case "Xanh": return "#1f73b7";
		  case "Đỏ": return "#d33f49";
		  default: return "#666"; // Không xác định
		}
	  }
	</script>
	
  </body>
</html>
